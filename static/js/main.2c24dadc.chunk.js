(this["webpackJsonpreact-chat-room"]=this["webpackJsonpreact-chat-room"]||[]).push([[0],{29:function(e,t,r){},31:function(e,t,r){},40:function(e,t,r){"use strict";r.r(t);var n=r(1),c=r.n(n),s=r(21),a=r.n(s),i=(r(29),r(18)),o=r.n(i),u=r(22),d=r(12),l=(r(31),r(13));l.a.apps.length?l.a.app():l.a.initializeApp({apiKey:"AIzaSyDgFG6npILcyixEjb-MUjuf5tBrw2dUTzg",authDomain:"react-firebase-chat-a7221.firebaseapp.com",projectId:"react-firebase-chat-a7221",storageBucket:"react-firebase-chat-a7221.appspot.com",messagingSenderId:"356316568421",appId:"1:356316568421:web:d41e35bf3ff96b8cdcdf8c",measurementId:"G-M860FG15VC"});var j=l.a,b=(r(32),r(41),r(24)),h=r(19),p=r(43),f=(r(35),r(5)),m=j.auth(),O=j.firestore();function g(){return Object(f.jsx)("button",{className:"sign-in",onClick:function(){var e=new j.auth.GoogleAuthProvider;m.signInWithPopup(e).then((function(e){var t=e.user,r=O.collection("users");console.log(t),r.where("uid","==",t.uid).get().then((function(e){e.empty?(console.log("New User"),r.add({uid:t.uid,photoURL:t.photoURL,userName:t.displayName,mailId:t.email,createdAt:j.firestore.FieldValue.serverTimestamp()}).then((function(){return console.log("user added")}))):console.log("Existed user")}))}))},children:"Sign in"})}function v(){return m.currentUser&&Object(f.jsx)("button",{onClick:function(){return m.signOut()},children:"sign out"})}function x(e){var t=O.collection("users").orderBy("createdAt"),r=Object(h.a)(t,{idField:"id"}),n=Object(d.a)(r,1)[0];return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)(p.a.Control,{as:"select",className:"select-user",onChange:function(t){e.selectPerson(t.target.value)},children:[Object(f.jsx)("option",{value:"",children:"Please Select User"}),void 0!==n&&n.map((function(e){return e.uid===m.currentUser.uid?"":Object(f.jsx)("option",{value:e.uid,children:e.userName},e.id)}))]})})}function U(e){var t,r=O.collection("chat_messages");t=r.where("convo","in",[m.currentUser.uid+e.person,e.person+m.currentUser.uid]).orderBy("createdAt");var c=Object(h.a)(t,{idField:"id"}),s=Object(d.a)(c,1)[0],a=Object(n.useState)(""),i=Object(d.a)(a,2),l=i[0],b=i[1],p=Object(n.useRef)(),g=function(){var t=Object(u.a)(o.a.mark((function t(n){var c,s,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),c=m.currentUser,s=c.uid,a=c.photoURL,""!==l){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,r.add({text:l,uid:s,sender:s,receiver:e.person,photoURL:a,convo:s+e.person,createdAt:j.firestore.FieldValue.serverTimestamp()});case 6:b(""),p.current.scrollIntoView({behavior:"smooth"});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("main",{children:[void 0!==s&&s.map((function(e){return Object(f.jsx)(F,{message:e},e.id)})),Object(f.jsx)("div",{ref:p})]}),Object(f.jsxs)("form",{onSubmit:g,className:"form",children:[Object(f.jsx)("input",{value:l,onChange:function(e){return b(e.target.value)}}),Object(f.jsx)("button",{type:"submit",children:Object(f.jsx)("i",{className:"material-icons",children:"send"})})]})]})}function F(e){var t=e.message,r=t.text,n=t.uid,c=t.photoURL,s=n===m.currentUser.uid?"sent":"received";return Object(f.jsxs)("div",{className:"message ".concat(s),children:[Object(f.jsx)("img",{src:c,alt:"user-pic"}),Object(f.jsx)("div",{children:r})]})}var w=function(){var e=Object(b.a)(m),t=Object(d.a)(e,1)[0],r=Object(n.useState)(""),c=Object(d.a)(r,2),s=c[0],a=c[1];return Object(f.jsxs)("div",{className:"App",children:[Object(f.jsxs)("header",{children:[Object(f.jsx)("h1",{children:"\ud83d\udcac"}),Object(f.jsx)(v,{})]}),Object(f.jsx)("section",{children:t?""===s?Object(f.jsx)(x,{selectPerson:a}):Object(f.jsx)(U,{person:s}):Object(f.jsx)(g,{})})]})},I=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,44)).then((function(t){var r=t.getCLS,n=t.getFID,c=t.getFCP,s=t.getLCP,a=t.getTTFB;r(e),n(e),c(e),s(e),a(e)}))};a.a.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsx)(w,{})}),document.getElementById("root")),I()}},[[40,1,2]]]);
//# sourceMappingURL=main.2c24dadc.chunk.js.map