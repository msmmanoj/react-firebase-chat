(this["webpackJsonpreact-chat-room"]=this["webpackJsonpreact-chat-room"]||[]).push([[0],{29:function(e,t,n){},31:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),s=n(21),a=n.n(s),i=(n(29),n(18)),o=n.n(i),u=n(22),d=n(12),l=(n(31),n(13)),j={apiKey:"AIzaSyDgFG6npILcyixEjb-MUjuf5tBrw2dUTzg",authDomain:"react-firebase-chat-a7221.firebaseapp.com",projectId:"react-firebase-chat-a7221",storageBucket:"react-firebase-chat-a7221.appspot.com",messagingSenderId:"356316568421",appId:"1:356316568421:web:d41e35bf3ff96b8cdcdf8c",measurementId:"G-M860FG15VC"};console.log(j),l.a.apps.length?l.a.app():l.a.initializeApp(j);var b=l.a,h=(n(32),n(41),n(24)),p=n(19),f=n(43),m=(n(35),n(5)),O=b.auth(),g=b.firestore();function x(){return Object(m.jsx)("button",{className:"sign-in",onClick:function(){var e=new b.auth.GoogleAuthProvider;O.signInWithPopup(e).then((function(e){var t=e.user,n=g.collection("users");console.log(t),n.where("uid","==",t.uid).get().then((function(e){e.empty?(console.log("New User"),n.add({uid:t.uid,photoURL:t.photoURL,userName:t.displayName,mailId:t.email,createdAt:b.firestore.FieldValue.serverTimestamp()}).then((function(){return console.log("user added")}))):console.log("Existed user")}))}))},children:"Sign in"})}function v(){return O.currentUser&&Object(m.jsx)("button",{onClick:function(){return O.signOut()},children:"sign out"})}function U(e){var t=g.collection("users").orderBy("createdAt"),n=Object(p.a)(t,{idField:"id"}),r=Object(d.a)(n,1)[0];console.log("AIzaSyDgFG6npILcyixEjb-MUjuf5tBrw2dUTzg");return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)(f.a.Control,{as:"select",className:"select-user",onChange:function(t){e.selectPerson(t.target.value)},children:[Object(m.jsx)("option",{value:"",children:"Please Select User"}),void 0!==r&&r.map((function(e){return e.uid===O.currentUser.uid?"":Object(m.jsx)("option",{value:e.uid,children:e.userName},e.id)}))]})})}function w(e){var t,n=g.collection("chat_messages");t=n.where("convo","in",[O.currentUser.uid+e.person,e.person+O.currentUser.uid]).orderBy("createdAt");var c=Object(p.a)(t,{idField:"id"}),s=Object(d.a)(c,1)[0],a=Object(r.useState)(""),i=Object(d.a)(a,2),l=i[0],j=i[1],h=Object(r.useRef)(),f=function(){var t=Object(u.a)(o.a.mark((function t(r){var c,s,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),c=O.currentUser,s=c.uid,a=c.photoURL,""!==l){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,n.add({text:l,uid:s,sender:s,receiver:e.person,photoURL:a,convo:s+e.person,createdAt:b.firestore.FieldValue.serverTimestamp()});case 6:j(""),h.current.scrollIntoView({behavior:"smooth"});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("main",{children:[void 0!==s&&s.map((function(e){return Object(m.jsx)(F,{message:e},e.id)})),Object(m.jsx)("div",{ref:h})]}),Object(m.jsxs)("form",{onSubmit:f,className:"form",children:[Object(m.jsx)("button",{onClick:function(){e.selectPerson("")},children:Object(m.jsx)("i",{className:"material-icons",children:"arrow_back"})}),Object(m.jsx)("input",{value:l,onChange:function(e){return j(e.target.value)}}),Object(m.jsx)("button",{type:"submit",children:Object(m.jsx)("i",{className:"material-icons",children:"send"})})]})]})}function F(e){var t=e.message,n=t.text,r=t.uid,c=t.photoURL,s=r===O.currentUser.uid?"sent":"received";return Object(m.jsxs)("div",{className:"message ".concat(s),children:[Object(m.jsx)("img",{src:c,alt:"user-pic"}),Object(m.jsx)("div",{children:n})]})}var I=function(){var e=Object(h.a)(O),t=Object(d.a)(e,1)[0],n=Object(r.useState)(""),c=Object(d.a)(n,2),s=c[0],a=c[1];return Object(m.jsxs)("div",{className:"App",children:[Object(m.jsxs)("header",{children:[Object(m.jsx)("h1",{children:"\ud83d\udcac"}),Object(m.jsx)(v,{})]}),Object(m.jsx)("section",{children:t?""===s?Object(m.jsx)(U,{selectPerson:a}):Object(m.jsx)(w,{person:s,selectPerson:a}):Object(m.jsx)(x,{})})]})},y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,44)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,s=t.getLCP,a=t.getTTFB;n(e),r(e),c(e),s(e),a(e)}))};a.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(I,{})}),document.getElementById("root")),y()}},[[40,1,2]]]);
//# sourceMappingURL=main.8dd7eda4.chunk.js.map