(this["webpackJsonpreact-chat-room"]=this["webpackJsonpreact-chat-room"]||[]).push([[0],{29:function(e,t,n){},31:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),s=n(21),a=n.n(s),i=(n(29),n(18)),o=n.n(i),u=n(22),d=n(12),l=(n(31),n(13));l.a.apps.length?l.a.app():l.a.initializeApp({apiKey:"AIzaSyDgFG6npILcyixEjb-MUjuf5tBrw2dUTzg",authDomain:"react-firebase-chat-a7221.firebaseapp.com",projectId:"react-firebase-chat-a7221",storageBucket:"react-firebase-chat-a7221.appspot.com",messagingSenderId:"356316568421",appId:"1:356316568421:web:d41e35bf3ff96b8cdcdf8c",measurementId:"G-M860FG15VC"});var j=l.a,b=(n(32),n(41),n(24)),h=n(19),p=n(43),f=(n(35),n(5)),m=j.auth(),O=j.firestore();function x(){return Object(f.jsx)("button",{className:"sign-in",onClick:function(){var e=new j.auth.GoogleAuthProvider;m.signInWithPopup(e).then((function(e){var t=e.user,n=O.collection("users");console.log(t),n.where("uid","==",t.uid).get().then((function(e){e.empty?(console.log("New User"),n.add({uid:t.uid,photoURL:t.photoURL,userName:t.displayName,mailId:t.email,createdAt:j.firestore.FieldValue.serverTimestamp()}).then((function(){return console.log("user added")}))):console.log("Existed user")}))}))},children:"Sign in"})}function g(){return m.currentUser&&Object(f.jsx)("button",{onClick:function(){return m.signOut()},children:"sign out"})}function v(e){var t=O.collection("users").orderBy("createdAt"),n=Object(h.a)(t,{idField:"id"}),r=Object(d.a)(n,1)[0];return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)(p.a.Control,{as:"select",className:"select-user",onChange:function(t){e.selectPerson(t.target.value)},children:[Object(f.jsx)("option",{value:"",children:"Please Select User"}),void 0!==r&&r.map((function(e){return e.uid===m.currentUser.uid?"":Object(f.jsx)("option",{value:e.uid,children:e.userName},e.id)}))]})})}function U(e){var t,n=O.collection("chat_messages");t=n.where("convo","in",[m.currentUser.uid+e.person,e.person+m.currentUser.uid]).orderBy("createdAt");var c=Object(h.a)(t,{idField:"id"}),s=Object(d.a)(c,1)[0],a=Object(r.useState)(""),i=Object(d.a)(a,2),l=i[0],b=i[1],p=Object(r.useRef)(),x=function(){var t=Object(u.a)(o.a.mark((function t(r){var c,s,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),c=m.currentUser,s=c.uid,a=c.photoURL,""!==l){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,n.add({text:l,uid:s,sender:s,receiver:e.person,photoURL:a,convo:s+e.person,createdAt:j.firestore.FieldValue.serverTimestamp()});case 6:b(""),p.current.scrollIntoView({behavior:"smooth"});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("main",{children:[void 0!==s&&s.map((function(e){return Object(f.jsx)(w,{message:e},e.id)})),Object(f.jsx)("div",{ref:p})]}),Object(f.jsxs)("form",{onSubmit:x,className:"form",children:[Object(f.jsx)("button",{onClick:function(){e.selectPerson("")},children:Object(f.jsx)("i",{className:"material-icons",children:"arrow_back"})}),Object(f.jsx)("input",{value:l,onChange:function(e){return b(e.target.value)}}),Object(f.jsx)("button",{type:"submit",children:Object(f.jsx)("i",{className:"material-icons",children:"send"})})]})]})}function w(e){var t=e.message,n=t.text,r=t.uid,c=t.photoURL,s=r===m.currentUser.uid?"sent":"received";return Object(f.jsxs)("div",{className:"message ".concat(s),children:[Object(f.jsx)("img",{src:c,alt:"user-pic"}),Object(f.jsx)("div",{children:n})]})}var F=function(){var e=Object(b.a)(m),t=Object(d.a)(e,1)[0],n=Object(r.useState)(""),c=Object(d.a)(n,2),s=c[0],a=c[1];return Object(f.jsxs)("div",{className:"App",children:[Object(f.jsxs)("header",{children:[Object(f.jsx)("h1",{children:"\ud83d\udcac"}),Object(f.jsx)(g,{})]}),Object(f.jsx)("section",{children:t?""===s?Object(f.jsx)(v,{selectPerson:a}):Object(f.jsx)(U,{person:s,selectPerson:a}):Object(f.jsx)(x,{})})]})},I=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,44)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,s=t.getLCP,a=t.getTTFB;n(e),r(e),c(e),s(e),a(e)}))};a.a.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsx)(F,{})}),document.getElementById("root")),I()}},[[40,1,2]]]);
//# sourceMappingURL=main.744de2fe.chunk.js.map