{"version":3,"sources":["firebase_config.js","App.js","reportWebVitals.js","index.js"],"names":["config","apiKey","process","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","console","log","firebase","apps","length","app","initializeApp","auth","firestore","SignIn","className","onClick","provider","GoogleAuthProvider","signInWithPopup","then","res","userDetails","user","users_ref","collection","where","uid","get","querySnapshot","empty","add","photoURL","userName","displayName","mailId","email","createdAt","FieldValue","serverTimestamp","SignOut","currentUser","signOut","UsersPortal","props","users_query","orderBy","useCollectionData","idField","users","Form","Control","as","onChange","e","selectPerson","target","value","undefined","map","id","ChatRoom","query","message_ref","person","messages","useState","formValue","setFormValue","dummy","useRef","sendMessage","a","preventDefault","text","sender","receiver","convo","current","scrollIntoView","behavior","msg","ChatMessage","message","ref","onSubmit","type","messageClass","src","alt","App","useAuthState","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.8dd7eda4.chunk.js","sourcesContent":["import firebase from 'firebase/app';\n\nconst config = {\n    apiKey: process.env.REACT_APP_API_KEY,\n    authDomain: process.env.REACT_APP_AUTH_DOMAIN,\n    projectId: process.env.REACT_APP_PROJECT_ID,\n    storageBucket: process.env.REACT_APP_STORAGE_BUCKET,\n    messagingSenderId: process.env.REACT_APP_MESSAGE_SENDER_ID,\n    appId: process.env.REACT_APP_APP_ID,\n    measurementId: process.env.REACT_APP_MEASURMENT_ID\n}\n\nconsole.log(config)\n\n!firebase.apps.length ? firebase.initializeApp(config) : firebase.app();\n\nexport default firebase","import {useState, useRef} from \"react\";\nimport './App.css';\nimport firebase from './firebase_config';\nimport 'firebase/auth';\nimport 'firebase/firestore';\nimport {useAuthState} from \"react-firebase-hooks/auth\";\nimport {useCollectionData} from \"react-firebase-hooks/firestore\";\nimport {Form} from 'react-bootstrap'\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nconst auth = firebase.auth();\nconst firestore = firebase.firestore();\n\n\nfunction App() {\n    const [user] = useAuthState(auth)\n\n    const [person, selectPerson] = useState('')\n\n    return (\n        <div className=\"App\">\n            <header>\n                <h1>ðŸ’¬</h1>\n                <SignOut/>\n            </header>\n            <section>\n                {user ? person === '' ? <UsersPortal selectPerson={selectPerson}/> : <ChatRoom person={person} selectPerson={selectPerson}/> :\n                    <SignIn/>}\n            </section>\n        </div>\n    );\n}\n\n\nfunction SignIn() {\n    const signInWithGoogleProvider = () => {\n        const provider = new firebase.auth.GoogleAuthProvider();\n        auth.signInWithPopup(provider).then(res => {\n            let userDetails = res.user;\n            let users_ref = firestore.collection(\"users\")\n            console.log(userDetails)\n            users_ref.where(\"uid\", \"==\", userDetails.uid).get()\n                .then(function (querySnapshot) {\n                    if (!querySnapshot.empty) {\n                        console.log(\"Existed user\");\n                    } else {\n                        console.log(\"New User\");\n                        users_ref.add({\n                            uid: userDetails.uid,\n                            photoURL: userDetails.photoURL,\n                            userName: userDetails.displayName,\n                            mailId: userDetails.email,\n                            createdAt: firebase.firestore.FieldValue.serverTimestamp()\n                        }).then(() => console.log(\"user added\"))\n                    }\n                });\n        });\n    }\n    return (\n        <button className=\"sign-in\" onClick={signInWithGoogleProvider}>Sign in</button>\n    )\n}\n\nfunction SignOut() {\n    return auth.currentUser && (\n        <button onClick={() => auth.signOut()}>sign out</button>\n    )\n}\n\nfunction UsersPortal(props) {\n\n    const users_query = firestore.collection(\"users\").orderBy(\"createdAt\")\n    const [users] = useCollectionData(users_query, {idField: 'id'});\n    console.log(process.env.REACT_APP_API_KEY)\n    const selectUser = (e) => {\n        props.selectPerson(e.target.value)\n    }\n    return (\n        <>\n            <Form.Control\n                as=\"select\"\n                className=\"select-user\"\n                onChange={selectUser}\n            >\n                <option value=''>Please Select User</option>\n                {users !== undefined && users.map(user => {\n                    if (user.uid === auth.currentUser.uid) return ''\n                    return <option key={user.id} value={user.uid}>{user.userName}</option>\n                })\n                }\n            </Form.Control>\n        </>\n    )\n}\n\nfunction ChatRoom(props) {\n    const message_ref = firestore.collection(\"chat_messages\")\n    let query = {}\n    query = message_ref.where(\"convo\", \"in\", [auth.currentUser.uid + props.person, props.person + auth.currentUser.uid])\n        .orderBy(\"createdAt\")\n\n    const [messages] = useCollectionData(query, {idField: 'id'});\n    const [formValue, setFormValue] = useState('')\n\n    const dummy = useRef()\n    const sendMessage = async (e) => {\n        e.preventDefault()\n        const {uid, photoURL} = auth.currentUser;\n        if (formValue === '') return;\n        await message_ref.add({\n            text: formValue,\n            uid,\n            sender: uid,\n            receiver: props.person,\n            photoURL,\n            convo: uid + props.person,\n            createdAt: firebase.firestore.FieldValue.serverTimestamp()\n        })\n\n        setFormValue('');\n\n        dummy.current.scrollIntoView({behavior: 'smooth'})\n    }\n\n    const onSelectBack = () => {\n        props.selectPerson('')\n    }\n\n    return (\n        <>\n            <main>\n                {messages !== undefined && messages.map(msg =>\n                    <ChatMessage key={msg.id} message={msg}/>)\n                }\n                <div ref={dummy}/>\n            </main>\n            <form onSubmit={sendMessage} className=\"form\">\n                <button onClick={onSelectBack}><i className=\"material-icons\">arrow_back</i></button>\n                <input value={formValue} onChange={(e) => setFormValue(e.target.value)}/>\n                <button type=\"submit\"><i className=\"material-icons\">send</i></button>\n            </form>\n        </>\n    )\n}\n\nfunction ChatMessage(props) {\n    const {text, uid, photoURL} = props.message\n\n    const messageClass = uid === auth.currentUser.uid ? 'sent' : 'received'\n\n\n    return (\n        <div className={`message ${messageClass}`}>\n            <img src={photoURL} alt=\"user-pic\"/>\n            <div>{text}</div>\n        </div>\n    )\n\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}